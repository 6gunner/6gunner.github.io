# 框架沉淀

## Vue全家桶封装

源码地址：https://github.com/6gunner/vue-basic-framework/tree/master/src

###v1版本 

> 时间：2019.7.21日

- 加入了axios以及一些常用的拦截器。拦截器业务根据实际项目业务来写；
- 加入router和store。一般项目都会用到
- 加了组件的懒加载; 需要引入babel的插件

其他组件根据后面需要再考虑加入。





## 二次开发组件

之前在给公司做项目的时候，基于vue + element封装了一些项目的插件。

组件封装好了，但是怎么把他提取出来给小伙伴们一起使用就成了一个难题。这边经过一番研究，终于找到了一个最优的打包配置，记录一下。

> 首先看一下webpack的配置

不同于app的打包，library的打包有两个概念：`externals` 、`暴露library`

[externals](./Webpack#externals)把一些依赖不打包到bundle里，而是作为外部依赖项。

[output](./Webpack#output)用来设置打包library被引用时的，变量的引用方式。

```js
// 将library打包出去
const webpack = require("webpack");
const {CleanWebpackPlugin} = require('clean-webpack-plugin');

const vueLoaderConfig = require('./vue-loader.conf');
const path = require('path');
const version = require("./../package.json").version;

const utils = require('./utils')

module.exports = {
  // mode: 'production',
  entry: path.join(__dirname, '..', "src/index.js"),
  output: {
    path: path.join(__dirname, '..', 'dist'),
    filename: "gs-comps.js",
    library: "GsComps",
    libraryTarget: "umd",
  },
  resolve: {
    extensions: ['.js', '.vue'],
    alias: {
      '@': path.resolve('src'),
    }
  },
  externals: {
    underscore: {
      commonjs: 'underscore',
      commonjs2: 'underscore',
      amd: 'underscore',
      root: '_'
    },
    vue: 'Vue',
    vuex: 'vuex',
    'element-ui': {
      commonjs: 'element-ui',
      commonjs2: 'element-ui',
    },
    'element-ui/src/transitions/collapse-transition': 'element-ui/lib/transitions/collapse-transition',
    'element-ui/src/mixins/emitter': 'element-ui/lib/mixins/emitter',
    'element-ui/src/locale': 'element-ui/lib/locale',

  },
  module: {
    rules: [
      ...utils.styleLoaders({sourceMap: true, extract: true}),
      {
        test: /\.vue$/,
        loader: 'vue-loader',
        options: vueLoaderConfig,
      },
      {
        test: /\.js$/,
        exclude: /node_modules/,
        loader: "babel-loader",
      }
    ]
  },
  plugins: [
    new CleanWebpackPlugin(),
    new webpack.DefinePlugin({
      "process.env": {
        NODE_ENV: '"production"'
      },
      VERSION: JSON.stringify(require("../package.json").version)
    }),
    new webpack.LoaderOptionsPlugin({
      minimize: true,
      debug: false
    }),
    new webpack.optimize.UglifyJsPlugin({
      compress: {
        warnings: false
      },
      sourceMap: true,
      comments: false,
      beautify: false
    }),
  ]
};

```



> 然后看一下封装library的方式

```js
// library index.js
import EasySelect from './components/EasySelect'
import EasyTable from './components/EasyTable'
import EasyInput from './components/EasyInput'
import VirtualList from './components/VirtualList'
import VirtualTree from './components/VirtualTree'

const components = [
  EasySelect,
  EasyTable,
  EasyInput,
  VirtualList,
  VirtualTree
]

const install = function (Vue) {
  components.forEach(component => {
    Vue.component(component.name, component)
  })
}

if (typeof window !== 'undefined' && window.Vue) {
  install(window.Vue)
}

export default {
  install,
 	EasySelect,
  EasyTable,
  EasyInput,
  VirtualList,
  VirtualTree
}
```

组件的indexjs

```js
// 引入组件
import EasyTable from './EasyTable'
// 写install方法
EasyTable.install = function (Vue) {
  Vue.component(EasyTable.name, EasyTable)
}
export default EasyTable
```



> 测试过后，发布library

```js
"main": "dist/gs-comps.js" // 设置package.json的main入口，用来发布
```

```shell
npm publish
```



## 通用UI组件设计

搭建项目的时候，经常发现一些样式时可以复用的，所以这里总结一下我们项目中用到的通用UI组件。

### 整体布局篇



### 页面布局篇

#### 详情页面

简介：详情页面一般组成分为2部分，上面部分是label-value形式的描述信息。下面内容不固定，可以是table表格，也可能是一些tab页面。

示例：![image-20190829110153309](https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-03-18-031428.png)

