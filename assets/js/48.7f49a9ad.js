(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{408:function(t,s,a){"use strict";a.r(s);var n=a(25),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"umijs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#umijs"}},[t._v("#")]),t._v(" UmiJS")]),t._v(" "),a("p",[t._v("Umi 以路由为基础的，同时支持配置式路由和约定式路由，保证路由的功能完备，并以此进行功能扩展。然后==配以生命周期完善的插件体系==，覆盖从源码到构建产物的每个生命周期，支持各种功能扩展和业务需求。")]),t._v(" "),a("h2",{attrs:{id:"umijs的背后思想"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#umijs的背后思想"}},[t._v("#")]),t._v(" UmiJS的背后思想")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-11-25-000425.png",alt:"img"}})]),t._v(" "),a("p",[t._v("如上图所示，umi将很多插件集合到了一起。然后收敛起来，让开发者只需要用Umi就可以实现开发。")]),t._v(" "),a("p",[a("strong",[t._v("插件收敛思想")])]),t._v(" "),a("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-11-25-000628.png",alt:"img"}}),t._v(" "),a("h2",{attrs:{id:"快速入门"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#快速入门"}},[t._v("#")]),t._v(" 快速入门")]),t._v(" "),a("h3",{attrs:{id:"利用cli来搭建项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#利用cli来搭建项目"}},[t._v("#")]),t._v(" 利用cli来搭建项目")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("➜  private mkdir umi-learn\n➜  private cd umi-learn\n➜  umi-learn yarn create @umijs/umi-app\n")])])]),a("h3",{attrs:{id:"本地验证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#本地验证"}},[t._v("#")]),t._v(" 本地验证")]),t._v(" "),a("p",[t._v("发布之前，可以通过 "),a("code",[t._v("serve")]),t._v(" 做本地验证，")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" global "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" serve\n$ serve ./dist\n\nServing"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n\n- Local:            http://localhost:5000\n- On Your Network:  http://"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("Your IP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(":5000\n\nCopied "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v(" address to clipboard"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n")])])]),a("p",[t._v("访问 http://localhost:5000，正常情况下应该是和 "),a("code",[t._v("umi dev")]),t._v(" 一致的。")]),t._v(" "),a("h3",{attrs:{id:"部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署"}},[t._v("#")]),t._v(" 部署")]),t._v(" "),a("p",[t._v("本地验证完，就可以部署了，这里通过 "),a("a",{attrs:{href:"http://now.sh/",target:"_blank",rel:"noopener noreferrer"}},[t._v("now"),a("OutboundLink")],1),t._v(" 来做演示。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" global "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" now\n$ now ./dist\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Deploying /private/tmp/sorrycc-1KVCmK/dist under chencheng\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Synced "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" files "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),t._v(".93KB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("2s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" https://dist-jtckzjjatx.now.sh "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("in clipboard"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("1s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Deployment complete"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n")])])]),a("p",[t._v("通过now + zeit可以学会自动部署 https://zeit.co/account")]),t._v(" "),a("h2",{attrs:{id:"目录说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#目录说明"}},[t._v("#")]),t._v(" 目录说明")]),t._v(" "),a("h2",{attrs:{id:"约定路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#约定路由"}},[t._v("#")]),t._v(" 约定路由")]),t._v(" "),a("h3",{attrs:{id:"动态路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#动态路由"}},[t._v("#")]),t._v(" 动态路由")]),t._v(" "),a("p",[t._v("umi 里约定，带 "),a("code",[t._v("$")]),t._v(" 前缀的目录或文件为动态路由。")]),t._v(" "),a("p",[t._v("比如以下目录结构：")]),t._v(" "),a("div",{staticClass:"language-tex extra-class"},[a("pre",{pre:!0,attrs:{class:"language-tex"}},[a("code",[t._v("+ pages/\n  + "),a("span",{pre:!0,attrs:{class:"token equation string"}},[t._v("$post/\n    - index.js\n    - comments.js\n  + users/\n    $")]),t._v("id.js\n  - index.js\n")])])]),a("p",[t._v("会生成路由配置如下：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" component"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./pages/index.js'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//约定$id文件名会创建一个:id的路由，代表一个变量")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/users/:id'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" component"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./pages/users/$id.js'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// $post = :post;")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/:post/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" component"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./pages/$post/index.js'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/:post/comments'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" component"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./pages/$post/comments.js'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("h3",{attrs:{id:"可选的动态路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可选的动态路由"}},[t._v("#")]),t._v(" 可选的动态路由")]),t._v(" "),a("p",[t._v("umi 里约定动态路由如果带 "),a("code",[t._v("$")]),t._v(" 后缀，则为可选动态路由。")]),t._v(" "),a("p",[t._v("比如以下结构：")]),t._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("+ pages/\n  + users/\n    - $id$.js\n  - index.js\n")])])]),a("p",[t._v("会生成路由配置如下：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" component"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./pages/index.js'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/users/:id?'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" component"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./pages/users/$id$.js'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("h2",{attrs:{id:"配置路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置路由"}},[t._v("#")]),t._v(" 配置路由")]),t._v(" "),a("p",[t._v("在"),a("code",[t._v(".umirc.(ts|js)")]),t._v(" 或者 "),a("code",[t._v("config/config.(ts|js)")]),t._v(" 文件中配置 "),a("code",[t._v("routes")]),t._v(" 属性，"),a("strong",[t._v("此配置项存在时则不会对 "),a("code",[t._v("src/pages")]),t._v(" 目录做约定式的解析")]),t._v("。")]),t._v(" "),a("p",[t._v("配置文档：https://umijs.org/zh/config/#routes")]),t._v(" "),a("div",{staticClass:"language-diff extra-class"},[a("pre",{pre:!0,attrs:{class:"language-diff"}},[a("code",[t._v("// component 指向的路由组件文件是从 src/pages 目录开始解析的\n"),a("span",{pre:!0,attrs:{class:"token unchanged"}},[t._v("  routes: [\n    {\n      path: '/',\n")]),a("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t._v("+     exact: true,\n")]),a("span",{pre:!0,attrs:{class:"token unchanged"}},[t._v("      component: '../layouts/index',\n      routes: [\n        { path: '/', component: './index' },\n      ],\n    }, {\n      path: '/users',\n      component: '../layouts/index',\n      routes: [\n        { path: '/users', component: './users/index' },\n        { path: '/users/:id', component: './users/$id' },\n      ]\n    }\n  ],\n")])])])]),a("h3",{attrs:{id:"路由权限配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路由权限配置"}},[t._v("#")]),t._v(" 路由权限配置")]),t._v(" "),a("div",{staticClass:"language-diff extra-class"},[a("pre",{pre:!0,attrs:{class:"language-diff"}},[a("code",[t._v("routes: [\n...\n"),a("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[t._v("+ {\n+\t\n+  \tpath: '/list',\n+  \tcomponent: './list/index',\n+  \t// 渲染都会经过 ./routes/PrivateRoute.js，需要从src目录下配置目录\n+  \tRoutes: ['./src/routes/PrivateRoute.js']  \n+}\n")]),t._v("...\n]\n")])])]),a("p",[a("strong",[t._v("PrivateRoutes")]),t._v("参考逻辑")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sessionStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PrivateRoute")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("routes"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("PrivateRoute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("PrivateRoute")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("routes"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("PrivateRoute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("h2",{attrs:{id:"插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#插件"}},[t._v("#")]),t._v(" 插件")]),t._v(" "),a("p",[t._v("https://v2.umijs.org/zh/plugin/umi-plugin-react.html#%E5%AE%89%E8%A3%85")]),t._v(" "),a("h2",{attrs:{id:"roadhog的配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#roadhog的配置"}},[t._v("#")]),t._v(" roadhog的配置")]),t._v(" "),a("p",[t._v("https://github.com/sorrycc/blog/issues/55")])])}),[],!1,null,null,null);s.default=r.exports}}]);