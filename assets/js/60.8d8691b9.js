(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{420:function(t,s,a){"use strict";a.r(s);var n=a(25),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"怎么造一个组件库？"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#怎么造一个组件库？"}},[t._v("#")]),t._v(" 怎么造一个组件库？")]),t._v(" "),a("h3",{attrs:{id:"_1、组件库的结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、组件库的结构"}},[t._v("#")]),t._v(" 1、组件库的结构")]),t._v(" "),a("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-09-23-034848.png",alt:"image-20200923114847910"}}),t._v(" "),a("h3",{attrs:{id:"_2、组件库的样式方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、组件库的样式方案"}},[t._v("#")]),t._v(" 2、组件库的样式方案")]),t._v(" "),a("p",[t._v("​\t我们采用sass来作为样式的实现方案")]),t._v(" "),a("p",[t._v("​\t对应的样式系统文件结构如下")]),t._v(" "),a("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-09-22-104809.png",alt:"image-20200922184808813"}}),t._v(" "),a("h3",{attrs:{id:"_3、组件库的颜色体系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、组件库的颜色体系"}},[t._v("#")]),t._v(" 3、组件库的颜色体系")]),t._v(" "),a("p",[t._v("​\t一般一个系统的颜色体系有两块：基础色、中性色。")]),t._v(" "),a("p",[t._v("​\t"),a("strong",[t._v("基础色")]),t._v("就是系统的主色调，主色调又可以生成对应的衍生色。像antd-design里提供了12个主色以及对应的衍生色，可以选择。")]),t._v(" "),a("p",[t._v("​\t"),a("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-09-23-055700.png",alt:"image-20200923135700536"}})]),t._v(" "),a("p",[t._v("​\t我们设计师说🐜的这套，一般用6号色作为基础色，然后对应的按钮的悬浮、点击的颜色，相差一位色调就可以。")]),t._v(" "),a("p",[t._v("​\t"),a("strong",[t._v("中性色")]),t._v("是用来一般用来定义文字的颜色")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-09-23-055538.png",alt:"image-20200923135538356"}})]),t._v(" "),a("p",[t._v("​\t"),a("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-09-23-055917.png",alt:"image-20200923135916998"}})]),t._v(" "),a("p",[t._v("除了基础色和中性色之外，剩下的就是"),a("strong",[t._v("功能色")]),t._v("。比如")]),t._v(" "),a("p",[t._v("​\t"),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-09-23-055836.png",alt:"image-20200923135836751"}})]),t._v(" "),a("h3",{attrs:{id:"_4、定义组件库的变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、定义组件库的变量"}},[t._v("#")]),t._v(" 4、定义组件库的变量")]),t._v(" "),a("p",[t._v("组件库的变量需要进行分类")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("基础色彩系统")])]),t._v(" "),a("li",[a("p",[t._v("字体系统(font-family、字体大小、字重、行高、标题大小、颜色)")])]),t._v(" "),a("li",[a("p",[t._v("表单")])]),t._v(" "),a("li",[a("p",[t._v("按钮")])]),t._v(" "),a("li",[a("p",[t._v("边框、阴影（修饰类）")])])]),t._v(" "),a("p",[t._v("看看蚂蚁ant-design的结构设计，他们的样式代码库非常有条理")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("color 里定义了一些颜色，和他们设计的没人能看懂的算法，这些算法可以去轻微修改主色的色调，形成一个色调版。")])]),t._v(" "),a("li",[a("p",[t._v("core  定义了很多基础的、通用的样式，并且做了浏览器的兼容，确保各个浏览器样式一致。")]),t._v(" "),a("ul",[a("li",[t._v("motion 定义了一些动画效果keyframes")])])]),t._v(" "),a("li",[a("p",[t._v("mixins 定义了一些混入方法 主要用来在组件里，通过一些变量，来修改一些样式，减少代码重复。")])]),t._v(" "),a("li",[a("p",[t._v("themes就是主题样式")])])]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-09-30-094747.png",alt:"image-20200930174746477"}}),t._v(" "),a("h3",{attrs:{id:"_5、设计一个button组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、设计一个button组件"}},[t._v("#")]),t._v(" 5、设计一个Button组件")]),t._v(" "),a("p",[a("strong",[t._v("首先看一下button组件代码的目录结构")])]),t._v(" "),a("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-10-12-224502.png",alt:"image-20201013064502200"}}),t._v(" "),a("p",[t._v("_style.scss 存放了button组件的所有样式，为什么要用"),a("code",[t._v("\\_")]),t._v("开头命名，因为在sass中这样的命名会默认认为这是被别的代码样式所依赖的。")]),t._v(" "),a("p",[t._v("button.tsx里是定义了组件的核心功能")]),t._v(" "),a("p",[t._v("index.tsx主要是定义了组件的名称，做一个统一导入导出。")]),t._v(" "),a("p",[a("strong",[t._v("其次来分析一下button组件的功能")])]),t._v(" "),a("p",[t._v("下面这个表格列举了button组件的一些props")]),t._v(" "),a("p",[t._v("不同的button type要展示不同的按钮样式，不同的button size对应按钮的大小也不同，然后button组件肯定要能支持html本身的属性，不能丢掉这些功能。比如onClick, disabled 等等。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("button type")]),t._v(" "),a("th",[t._v("button size")]),t._v(" "),a("th",[t._v("固有属性")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("primary")]),t._v(" "),a("td",[t._v("lg")]),t._v(" "),a("td",[t._v("html-button标签固有的属性")])]),t._v(" "),a("tr",[a("td",[t._v("default")]),t._v(" "),a("td",[t._v("md")]),t._v(" "),a("td",[t._v("html-a标签固有的属性")])]),t._v(" "),a("tr",[a("td",[t._v("text")]),t._v(" "),a("td",[t._v("sm")]),t._v(" "),a("td",[t._v("React.children")])]),t._v(" "),a("tr",[a("td",[t._v("Link")]),t._v(" "),a("td"),t._v(" "),a("td")])])]),t._v(" "),a("p",[a("strong",[t._v("最后来编写button组件的代码")])]),t._v(" "),a("p",[t._v("按照上面的props，定义好组件的type。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-10-12-225420.png",alt:"image-20201013065419359"}})]),t._v(" "),a("p",[t._v("在button组件里，针对传入的props，来使用不同的样式")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-10-12-225737.png",alt:"image-20201013065736873"}})]),t._v(" "),a("p",[t._v("这里面最复杂的就是样式代码的编写，要让它变得有条理，可配置，可复用。")]),t._v(" "),a("p",[t._v("先引入第3步定好的组件库的变量")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-10-12-230004.png",alt:"image-20201013070003944"}}),t._v(" "),a("p",[t._v("再定义好基础的btn样式")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-10-12-230100.png",alt:"image-20201013070100494"}}),t._v(" "),a("p",[t._v("这里用到了两个mixins函数，就是为了方便去重写不同type和size的btn的样式, 代码如下。")]),t._v(" "),a("div",{staticClass:"language-scss extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scss"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("@mixin")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("btn-size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$padding")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fontSize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$height")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("padding")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$padding")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("font-size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$fontSize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("height")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$height")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("@mixin")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("btn-style")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$bgColor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$borderColor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$color")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hoverBgColor")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("lighten")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$bgColor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 7.5%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hoverBorderColor")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$borderColor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hoverColor")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$color")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("color")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$color")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("background")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$bgColor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("border-color")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$borderColor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token selector"}},[a("span",{pre:!0,attrs:{class:"token parent important"}},[t._v("&")]),t._v(":hover ")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("color")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hoverColor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("background")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hoverBgColor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("border-color")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hoverBorderColor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token selector"}},[a("span",{pre:!0,attrs:{class:"token parent important"}},[t._v("&")]),t._v(":focus,\n  "),a("span",{pre:!0,attrs:{class:"token parent important"}},[t._v("&")]),t._v(".focus ")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("color")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hoverColor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("background")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hoverBgColor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("border-color")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$hoverBorderColor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token selector"}},[a("span",{pre:!0,attrs:{class:"token parent important"}},[t._v("&")]),t._v(".active,\n  "),a("span",{pre:!0,attrs:{class:"token parent important"}},[t._v("&")]),t._v(":active ")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("outline")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("-webkit-box-shadow")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" none"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("box-shadow")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" none"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("接下来就是针对不同的type和size，定义不同的css类名，修改样式也用到了上面的mixins方法")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-10-12-230326.png",alt:"image-20201013070325819"}})]),t._v(" "),a("h3",{attrs:{id:"_6、测试react组件库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6、测试react组件库"}},[t._v("#")]),t._v(" 6、测试react组件库")]),t._v(" "),a("p",[t._v("单元测试是组件库里很重要的一部分。")]),t._v(" "),a("p",[t._v("除了使用jest这一个通用的测试库之外，react组件的单元测试还需要用到一些专门的测试lib。")]),t._v(" "),a("p",[t._v("react官网给我们推荐了"),a("code",[t._v("@testing-library/react")]),t._v("这一个库。")]),t._v(" "),a("p",[t._v("地址：https://github.com/testing-library/react-testing-library#basic-example")]),t._v(" "),a("p",[t._v("它还有一系列的断言插件库，帮助写测试用例")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"@testing-library/jest-dom"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^4.2.4"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"@testing-library/react"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^9.3.2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"@testing-library/user-event"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^7.1.2"')]),t._v("\n")])])]),a("p",[t._v("react这个库里提供了render, fireEvent等方法")]),t._v(" "),a("p",[t._v("Jest-dom提供了很多api用来帮助dom的判断：https://github.com/testing-library/jest-dom")]),t._v(" "),a("p",[t._v("jest这个库提供了一些通用的方法：https://jestjs.io/docs/en/mock-functions")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("describe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Button Test'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("it")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'should render normal btn'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" onClick "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" jest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义一个mock方法")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" document "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Button data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("testid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"button"')]),t._v(" onClick"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("onClick"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Test"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Button"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 拿到一个dom")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" btn "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getByTestId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'button'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取到组件")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("btn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toHaveClass")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'btn'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ez-btn'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//判断class")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" element "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getByText")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Test'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toEqual")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Test'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//判断文本")]),t._v("\n  fireEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("click")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("btn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("onClick"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("calls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toBe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断事件的触发")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"_7、设计一个menu组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7、设计一个menu组件"}},[t._v("#")]),t._v(" 7、设计一个Menu组件")]),t._v(" "),a("h4",{attrs:{id:"同样先分析menu组件的需求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#同样先分析menu组件的需求"}},[t._v("#")]),t._v(" 同样先分析Menu组件的需求")]),t._v(" "),a("p",[t._v("下面这个表格列举了Menu组件的一些props")]),t._v(" "),a("p",[t._v("菜单有横向，有纵向的。")]),t._v(" "),a("p",[t._v("然后菜单里一般都有子菜单，有子菜单的一级菜单可以展开")]),t._v(" "),a("p",[t._v("菜单可以选中")]),t._v(" "),a("p",[t._v("每一个菜单，都有自己唯一标识，用来作为判断是否选中或者展开的依据")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Menu mode")]),t._v(" "),a("th",[t._v("其他属性")]),t._v(" "),a("th",[t._v("固有属性")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("horizontal")]),t._v(" "),a("td",[t._v("selectedKey")]),t._v(" "),a("td",[t._v("key")])]),t._v(" "),a("tr",[a("td",[t._v("vertical")]),t._v(" "),a("td",[t._v("defaultSelectedKey")]),t._v(" "),a("td",[t._v("className")])]),t._v(" "),a("tr",[a("td",[t._v("inline")]),t._v(" "),a("td",[t._v("defaultOpenKey")]),t._v(" "),a("td",[t._v("React.children")])]),t._v(" "),a("tr",[a("td"),t._v(" "),a("td",[t._v("openKey")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td"),t._v(" "),a("td",[t._v("onSelect?")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td"),t._v(" "),a("td",[t._v("eventKey")]),t._v(" "),a("td")])])]),t._v(" "),a("h4",{attrs:{id:"组件间通信"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组件间通信"}},[t._v("#")]),t._v(" 组件间通信")]),t._v(" "),a("p",[t._v("因为涉及到多个组件，当菜单点击时，事件需要从item里传递给父组件，来判断哪一个菜单被点击了，从而计算出选中的菜单，以及展开的菜单样式。")]),t._v(" "),a("p",[t._v("组件之间传递可以通过Provider.Context 或者 利用mini-store来实现。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-10-20-035641.png",alt:"image-20201020115640790"}})]),t._v(" "),a("h2",{attrs:{id:"零碎的知识点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#零碎的知识点"}},[t._v("#")]),t._v(" 零碎的知识点")]),t._v(" "),a("h3",{attrs:{id:"mini-store"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mini-store"}},[t._v("#")]),t._v(" mini-store")]),t._v(" "),a("p",[t._v("redux做的很棒的一件事情，是把状态维护到一个store里。然后组件可以订阅state的变化，只有connected的组件会去渲染他。")]),t._v(" "),a("p",[t._v("但是写组件库时，redux + react-redux就太重了。")]),t._v(" "),a("p",[t._v("所以用mini-store来创建一个store，但是没有reducer和dispatch、")]),t._v(" "),a("h3",{attrs:{id:"react-key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#react-key"}},[t._v("#")]),t._v(" React,key")]),t._v(" "),a("p",[t._v("key作为react的预留属性，是不会在props里被读取到的。")]),t._v(" "),a("p",[t._v("如果想要用key这个Props，需要在组件编译前，在内部将key复制给其他的props。")]),t._v(" "),a("p",[t._v("比如，我定义了一个Menu组件，我想用key作为menuItem的唯一主键，所以我需要在组件内部，将key拿到，然后eventKey来接收，传入到子组件里。")]),t._v(" "),a("p",[t._v("使用代码片段")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-10-25-120627.png",alt:"image-20201025200627030"}})]),t._v(" "),a("p",[t._v("Menu代码片段")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-10-25-120525.png",alt:"image-20201025200524213"}})]),t._v(" "),a("p",[t._v("子组件代码片段")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://ipic-coda.oss-cn-beijing.aliyuncs.com/2020-10-25-120807.png",alt:"image-20201025200807219"}})])])}),[],!1,null,null,null);s.default=e.exports}}]);