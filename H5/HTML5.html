<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Coda的博客</title>
    <meta name="generator" content="VuePress 1.5.1">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="闲着无聊？那就读书吧">
    <link rel="preload" href="/assets/css/0.styles.c3659042.css" as="style"><link rel="preload" href="/assets/js/app.b01f8b87.js" as="script"><link rel="preload" href="/assets/js/2.7c7b516a.js" as="script"><link rel="preload" href="/assets/js/15.6c792851.js" as="script"><link rel="prefetch" href="/assets/js/10.173dc7ad.js"><link rel="prefetch" href="/assets/js/100.eae183ae.js"><link rel="prefetch" href="/assets/js/101.3ee1db68.js"><link rel="prefetch" href="/assets/js/102.da53b891.js"><link rel="prefetch" href="/assets/js/103.16bc5390.js"><link rel="prefetch" href="/assets/js/104.b19a4efb.js"><link rel="prefetch" href="/assets/js/105.c08b9aed.js"><link rel="prefetch" href="/assets/js/106.fbac5ec5.js"><link rel="prefetch" href="/assets/js/107.9df00bbf.js"><link rel="prefetch" href="/assets/js/108.36713137.js"><link rel="prefetch" href="/assets/js/109.8bfddf69.js"><link rel="prefetch" href="/assets/js/11.0b45a4d2.js"><link rel="prefetch" href="/assets/js/110.09e4266c.js"><link rel="prefetch" href="/assets/js/111.895134a4.js"><link rel="prefetch" href="/assets/js/112.4ee4d403.js"><link rel="prefetch" href="/assets/js/113.6e981f22.js"><link rel="prefetch" href="/assets/js/114.da95feb6.js"><link rel="prefetch" href="/assets/js/115.f360a622.js"><link rel="prefetch" href="/assets/js/116.5adcbc0c.js"><link rel="prefetch" href="/assets/js/117.6781680b.js"><link rel="prefetch" href="/assets/js/118.e0c665e7.js"><link rel="prefetch" href="/assets/js/119.e5d260ea.js"><link rel="prefetch" href="/assets/js/12.92c6e45c.js"><link rel="prefetch" href="/assets/js/120.71ba7382.js"><link rel="prefetch" href="/assets/js/13.f01235bf.js"><link rel="prefetch" href="/assets/js/14.6f36b30a.js"><link rel="prefetch" href="/assets/js/16.c610593a.js"><link rel="prefetch" href="/assets/js/17.d424583c.js"><link rel="prefetch" href="/assets/js/18.f2df71d6.js"><link rel="prefetch" href="/assets/js/19.5fc8cebd.js"><link rel="prefetch" href="/assets/js/20.8995b21e.js"><link rel="prefetch" href="/assets/js/21.86b9bfb1.js"><link rel="prefetch" href="/assets/js/22.a0f9800b.js"><link rel="prefetch" href="/assets/js/23.c600b58d.js"><link rel="prefetch" href="/assets/js/24.48ac403d.js"><link rel="prefetch" href="/assets/js/25.27aa9981.js"><link rel="prefetch" href="/assets/js/26.603bdaff.js"><link rel="prefetch" href="/assets/js/27.5d192a7d.js"><link rel="prefetch" href="/assets/js/28.4f3e5982.js"><link rel="prefetch" href="/assets/js/29.716c51bf.js"><link rel="prefetch" href="/assets/js/3.507fd7ae.js"><link rel="prefetch" href="/assets/js/30.aafc607e.js"><link rel="prefetch" href="/assets/js/31.bdfd52fb.js"><link rel="prefetch" href="/assets/js/32.0d011539.js"><link rel="prefetch" href="/assets/js/33.748e0e64.js"><link rel="prefetch" href="/assets/js/34.8349e309.js"><link rel="prefetch" href="/assets/js/35.084d406c.js"><link rel="prefetch" href="/assets/js/36.0b2dce78.js"><link rel="prefetch" href="/assets/js/37.85f03f45.js"><link rel="prefetch" href="/assets/js/38.584eaacf.js"><link rel="prefetch" href="/assets/js/39.67c1dd42.js"><link rel="prefetch" href="/assets/js/4.484f1216.js"><link rel="prefetch" href="/assets/js/40.d1352a35.js"><link rel="prefetch" href="/assets/js/41.694d5292.js"><link rel="prefetch" href="/assets/js/42.571072a6.js"><link rel="prefetch" href="/assets/js/43.dba2fb81.js"><link rel="prefetch" href="/assets/js/44.d16f3d43.js"><link rel="prefetch" href="/assets/js/45.a80fe4d5.js"><link rel="prefetch" href="/assets/js/46.c6ea187c.js"><link rel="prefetch" href="/assets/js/47.e3f37508.js"><link rel="prefetch" href="/assets/js/48.7f49a9ad.js"><link rel="prefetch" href="/assets/js/49.2e431e0e.js"><link rel="prefetch" href="/assets/js/5.5858b048.js"><link rel="prefetch" href="/assets/js/50.d55d5479.js"><link rel="prefetch" href="/assets/js/51.f098c778.js"><link rel="prefetch" href="/assets/js/52.a7a42528.js"><link rel="prefetch" href="/assets/js/53.c8988d92.js"><link rel="prefetch" href="/assets/js/54.4af29f73.js"><link rel="prefetch" href="/assets/js/55.d96ea8bf.js"><link rel="prefetch" href="/assets/js/56.cc7e9b8c.js"><link rel="prefetch" href="/assets/js/57.e807c88e.js"><link rel="prefetch" href="/assets/js/58.13ed5ef4.js"><link rel="prefetch" href="/assets/js/59.a0830e9b.js"><link rel="prefetch" href="/assets/js/6.f73da795.js"><link rel="prefetch" href="/assets/js/60.8d8691b9.js"><link rel="prefetch" href="/assets/js/61.ebbc571f.js"><link rel="prefetch" href="/assets/js/62.bb6a1508.js"><link rel="prefetch" href="/assets/js/63.3655fdf8.js"><link rel="prefetch" href="/assets/js/64.5ccf4ac4.js"><link rel="prefetch" href="/assets/js/65.e48b166a.js"><link rel="prefetch" href="/assets/js/66.e10e2464.js"><link rel="prefetch" href="/assets/js/67.5ef309f9.js"><link rel="prefetch" href="/assets/js/68.ff92bb0f.js"><link rel="prefetch" href="/assets/js/69.538bbf7e.js"><link rel="prefetch" href="/assets/js/7.85224d23.js"><link rel="prefetch" href="/assets/js/70.aecadc23.js"><link rel="prefetch" href="/assets/js/71.7dd797e5.js"><link rel="prefetch" href="/assets/js/72.bbbb62c8.js"><link rel="prefetch" href="/assets/js/73.44a64935.js"><link rel="prefetch" href="/assets/js/74.5734e0fe.js"><link rel="prefetch" href="/assets/js/75.9eaaa3ea.js"><link rel="prefetch" href="/assets/js/76.888799eb.js"><link rel="prefetch" href="/assets/js/77.05d11301.js"><link rel="prefetch" href="/assets/js/78.e2a28ba2.js"><link rel="prefetch" href="/assets/js/79.8f1962e9.js"><link rel="prefetch" href="/assets/js/8.95d07ea6.js"><link rel="prefetch" href="/assets/js/80.df29dcd6.js"><link rel="prefetch" href="/assets/js/81.393d4b6c.js"><link rel="prefetch" href="/assets/js/82.bf8f0cdc.js"><link rel="prefetch" href="/assets/js/83.a1a88c99.js"><link rel="prefetch" href="/assets/js/84.a26427b1.js"><link rel="prefetch" href="/assets/js/85.666c5e39.js"><link rel="prefetch" href="/assets/js/86.eea33505.js"><link rel="prefetch" href="/assets/js/87.19fa760b.js"><link rel="prefetch" href="/assets/js/88.530eedcd.js"><link rel="prefetch" href="/assets/js/89.eb06a80b.js"><link rel="prefetch" href="/assets/js/9.041b6deb.js"><link rel="prefetch" href="/assets/js/90.2f263238.js"><link rel="prefetch" href="/assets/js/91.f0fd5d45.js"><link rel="prefetch" href="/assets/js/92.82878d0f.js"><link rel="prefetch" href="/assets/js/93.c34f020a.js"><link rel="prefetch" href="/assets/js/94.2543f30a.js"><link rel="prefetch" href="/assets/js/95.2c54472d.js"><link rel="prefetch" href="/assets/js/96.7ba419b3.js"><link rel="prefetch" href="/assets/js/97.03e5d4c8.js"><link rel="prefetch" href="/assets/js/98.0f492bd7.js"><link rel="prefetch" href="/assets/js/99.780751c2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c3659042.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Coda的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/服务端/" class="nav-link">
  服务端
</a></div><div class="nav-item"><a href="/前端/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/node/" class="nav-link">
  node
</a></div><div class="nav-item"><a href="/android/" class="nav-link">
  android
</a></div><div class="nav-item"><a href="/DevOps/" class="nav-link">
  devOps
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/服务端/" class="nav-link">
  服务端
</a></div><div class="nav-item"><a href="/前端/" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/node/" class="nav-link">
  node
</a></div><div class="nav-item"><a href="/android/" class="nav-link">
  android
</a></div><div class="nav-item"><a href="/DevOps/" class="nav-link">
  devOps
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="html5实用功能推荐"><a href="#html5实用功能推荐" class="header-anchor">#</a> HTML5实用功能推荐</h1> <h3 id="一、html5实用功能之application-cache"><a href="#一、html5实用功能之application-cache" class="header-anchor">#</a> 一、HTML5实用功能之Application Cache</h3> <h4 id="_1、application-cache的优点和应用场景"><a href="#_1、application-cache的优点和应用场景" class="header-anchor">#</a> 1、Application Cache的优点和应用场景</h4> <p><strong>优点</strong></p> <ul><li>离线浏览 – 用户可在离线时浏览您的完整网站</li> <li>速度 – 缓存资源为本地资源，因此加载速度较快。</li> <li>服务器负载更少 – 浏览器只会从发生了更改的服务器下载资源。</li></ul> <p><strong>应用场景</strong></p> <ul><li>完整的离线应用，可以缓存一些商户要展示给用户的重要资源信息。</li> <li>H5页面小游戏，当网络不稳定或者断网的情况下也可以继续进行。</li> <li>网站一些长期不变的公共资源，可以放缓存。</li> <li>其他。</li></ul> <h4 id="_2、application-cache的运行流程和文件规范"><a href="#_2、application-cache的运行流程和文件规范" class="header-anchor">#</a> 2、Application Cache的运行流程和文件规范</h4> <p><strong>运行流程</strong></p> <p><img src="images/appcache.jpg" alt=""></p> <p><strong>文件规范</strong></p> <div class="language-manifest extra-class"><pre class="language-text"><code>CACHE MANIFEST
# Javascript v9.6
CACHE:
	cache.css
	cache.js
	jquery-2.1.4.min.js
	test1.png
	test2.png
NETWORK:

FALLBACK:
</code></pre></div><p>第一行CACHE MANIFEST必须写，第二行通常为版本号注释信息，用来更新manifest文件，下面分别为要缓存的文件，需要通过网络获取的文件，以及从网络请求失败的替代页面。（<strong>本文重点讲述application cache使用时的注意点以及作者在测中踩过的坑，基本使用不作重点讲述。</strong>）</p> <h4 id="_3、使用application-cache的注意点和建议"><a href="#_3、使用application-cache的注意点和建议" class="header-anchor">#</a> 3、使用Application Cache的注意点和建议</h4> <ul><li>离线缓存文件要更新，一定要同步更新manifest文件（通常是注释版本号）。</li> <li>引用manifest文件的页面也会被缓存。</li> <li>如果manifest文件，或者内部列举的某一个文件不能正常下载，整个更新过程将视为失败，浏览器继续全部使用旧的缓存。</li> <li>页面不能跨域引用manifest文件，但是manifest中可以指定跨域资源进行缓存。</li> <li>FALLBACK中的资源必须和manifest文件同源。</li> <li>manifest缓存与http本身的缓存功能并不冲突，虽然更新manifest文件后会把manifest清单中的文件都重新去服务器请求一次，但是是基于http请求，此时http本身的缓存机制依然有效。</li> <li>虽然manifest清单中的NETWORK不是必写的，但是经过实测，页面中所需的资源是CACHE和NETWORK以及FALLBACK的并集，如果页面中引用的资源在三者中都没有指定，将不会获取，并不会默认从网络获取。</li> <li>站点中的其他页面即使没有设置manifest属性，请求的资源如果在缓存中也从缓存中访问。</li> <li>引用manifest页面若带参数，参数改变，浏览器会将页面认为是新的使用了application cache功能的页面，从而将该页面进行缓存，并且进行一次manifest的检查和拉取。</li></ul> <p>manifest的缓存加载和页面加载是异步的，所以manifest有更新时，需要刷新两次用户端才能实现更新。解决方法可以写一段脚本，判断当applicationcache状态为updateready时（此状态表示缓存资源更新了），提示用户更新页面，或者强制刷新。</p> <p>（示例如下）</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>window<span class="token punctuation">.</span>applicationCache<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'updateready'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>applicationCache<span class="token punctuation">.</span>status <span class="token operator">==</span> window<span class="token punctuation">.</span>applicationCache<span class="token punctuation">.</span><span class="token constant">UPDATEREADY</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
      window<span class="token punctuation">.</span>applicationCache<span class="token punctuation">.</span><span class="token function">swapCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'是否下载新版本?'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
          window<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
      <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>  
      <span class="token comment">// Manifest didn't changed. Nothing new to server.  </span>
 <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="二、html5实用功能之运动度传感器事件devicemotion和方向传感器事件deviceorientation"><a href="#二、html5实用功能之运动度传感器事件devicemotion和方向传感器事件deviceorientation" class="header-anchor">#</a> 二、HTML5实用功能之运动度传感器事件devicemotion和方向传感器事件deviceorientation</h3> <h4 id="_1、h5-devicemotion和deviceorientation基本介绍和应用背景。"><a href="#_1、h5-devicemotion和deviceorientation基本介绍和应用背景。" class="header-anchor">#</a> 1、H5 devicemotion和deviceorientation基本介绍和应用背景。</h4> <p><strong>基本介绍</strong></p> <ul><li><em>devicemotion</em>：封装了加速度传感器数据的事件。网页可以通过该事件获取到设备的加速度传数据。</li> <li><em>deviceorientation</em>：封装了方向传感器数据的事件。网页可以通过该事件获取到设备的方向信息。</li></ul> <p><strong>应用场景</strong></p> <p>可以基于以上一个或者两个，来获得硬件设备的运动情况，从而进行一些处理或者开发一些趣味应用，类似：</p> <ul><li>手机摇一摇（基于摇一摇的活动，例如摇一摇红包）。</li> <li>手机平衡球游戏等。</li> <li>体感游戏。</li> <li>等等。</li></ul> <h4 id="_2、h5-devicemotion-和deviceorientation-api使用方法。"><a href="#_2、h5-devicemotion-和deviceorientation-api使用方法。" class="header-anchor">#</a> 2、H5 devicemotion 和deviceorientation API使用方法。</h4> <p><strong>devicemotion</strong>：</p> <p><img src="images/devicemotion.png" alt=""></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">initMotion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>DeviceMotionEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>shakeFlag<span class="token punctuation">)</span><span class="token punctuation">{</span>
            window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'devicemotion'</span><span class="token punctuation">,</span> deviceMotionHandler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>                
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;not support!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre></div><p><strong>deviceorientation</strong>：</p> <p><img src="images/deviceorientation.png" alt=""></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">initorientation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>DeviceOrientationEvent<span class="token punctuation">)</span><span class="token punctuation">{</span>
	    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'deviceorientation'</span><span class="token punctuation">,</span>DeviceOrientationHandler<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
	    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;您的浏览器不支持DeviceOrientation&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_3、手机h5页面红包摇一摇demo"><a href="#_3、手机h5页面红包摇一摇demo" class="header-anchor">#</a> 3、手机H5页面红包摇一摇Demo</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;jquery-2.1.4.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>link href<span class="token operator">=</span><span class="token string">&quot;red.css&quot;</span> rel<span class="token operator">=</span><span class="token string">&quot;stylesheet&quot;</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>red<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>

	<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>body onload<span class="token operator">=</span><span class="token string">&quot;initMotion()&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;page1&quot;</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;red-wrap&quot;</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;circle&quot;</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>Lucky Money<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

	<span class="token operator">&lt;</span>btn id<span class="token operator">=</span><span class="token string">&quot;rules&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btn&quot;</span> onclick<span class="token operator">=</span><span class="token string">&quot;rulesToggle()&quot;</span><span class="token operator">&gt;</span>Rules<span class="token operator">&lt;</span><span class="token operator">/</span>btn<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>btn id<span class="token operator">=</span><span class="token string">&quot;tryAgain&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btn&quot;</span> onclick<span class="token operator">=</span><span class="token string">&quot;tryAgain()&quot;</span><span class="token operator">&gt;</span>Try Again<span class="token operator">&lt;</span><span class="token operator">/</span>btn<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;page2&quot;</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;rules-wrap&quot;</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>h2 id<span class="token operator">=</span><span class="token string">&quot;Rules&quot;</span><span class="token operator">&gt;</span>Rules<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>Shake your phone<span class="token punctuation">,</span>and you will <span class="token keyword">get</span> lucy money <span class="token keyword">of</span> random amount<span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>Click <span class="token string">&quot;Get My Luck&quot;</span><span class="token punctuation">,</span>and the money will be deposited into your account<span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>Share your luck to your friends via sharing game <span class="token keyword">this</span> to your friends<span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>		
		<span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>



<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
	<span class="token constant">SHAKE_THRESHOLD</span> <span class="token operator">=</span> <span class="token number">3000</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> last_update <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> x <span class="token operator">=</span> y <span class="token operator">=</span> z <span class="token operator">=</span> last_x <span class="token operator">=</span> last_y <span class="token operator">=</span> last_z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> shakeFlag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">function</span> <span class="token function">initMotion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>DeviceMotionEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>shakeFlag<span class="token punctuation">)</span><span class="token punctuation">{</span>
				window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'devicemotion'</span><span class="token punctuation">,</span> deviceMotionHandler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>         		 
	    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
	    	<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;not support!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	    <span class="token punctuation">}</span>  
	<span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">deviceMotionHandler</span><span class="token punctuation">(</span><span class="token parameter">eventData</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
	    <span class="token keyword">var</span> acceleration <span class="token operator">=</span> eventData<span class="token punctuation">.</span>acceleration<span class="token punctuation">;</span>  
	    <span class="token keyword">var</span> currTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
	    <span class="token keyword">var</span> diffTime <span class="token operator">=</span> currTime <span class="token operator">-</span> last_update<span class="token punctuation">;</span>  
	    <span class="token keyword">if</span> <span class="token punctuation">(</span>diffTime <span class="token operator">&gt;</span> <span class="token number">120</span> <span class="token operator">&amp;&amp;</span> shakeFlag <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
	        last_update <span class="token operator">=</span> currTime<span class="token punctuation">;</span>  
	        x <span class="token operator">=</span> acceleration<span class="token punctuation">.</span>x<span class="token punctuation">;</span>  
	        y <span class="token operator">=</span> acceleration<span class="token punctuation">.</span>y<span class="token punctuation">;</span>  
	        z <span class="token operator">=</span> acceleration<span class="token punctuation">.</span>z<span class="token punctuation">;</span>  
	        <span class="token keyword">var</span> speed <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>x <span class="token operator">+</span> y <span class="token operator">+</span> z <span class="token operator">-</span> last_x <span class="token operator">-</span> last_y <span class="token operator">-</span> last_z<span class="token punctuation">)</span> <span class="token operator">/</span> diffTime <span class="token operator">*</span> <span class="token number">30000</span><span class="token punctuation">;</span>  

	        <span class="token keyword">if</span> <span class="token punctuation">(</span>speed <span class="token operator">&gt;</span> <span class="token constant">SHAKE_THRESHOLD</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
	            <span class="token comment">//要一摇之后进行业务逻辑处理              </span>
	            <span class="token function">shaking</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        
	           <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>$<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;red.php&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	            	<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#circle span&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&quot;font-size&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;30px&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>data<span class="token operator">+</span><span class="token string">&quot; &quot;</span><span class="token operator">+</span><span class="token string">&quot;$&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	            shakeFlag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	        <span class="token punctuation">}</span>           
	        last_x <span class="token operator">=</span> x<span class="token punctuation">;</span>  
	        last_y <span class="token operator">=</span> y<span class="token punctuation">;</span>  
	        last_z <span class="token operator">=</span> z<span class="token punctuation">;</span>  
		<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">tryAgain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    	shakeFlag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    	<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#circle span&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">&quot;Lucky Money&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#red-wrap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">&quot;shaking&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#circle span&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&quot;font-size&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;20px&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#circle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&quot;background&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;yellow&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">rulesToggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#page2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    		<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#page2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;height&quot;</span><span class="token operator">:</span><span class="token string">&quot;68%&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;opacity&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    		<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#page2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;height&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;opacity&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>   	
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">shaking</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    	<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#red-wrap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">&quot;shaking&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">getRandomColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;#&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token string">&quot;00000&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">16777215</span><span class="token operator">+</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">function</span> <span class="token function">colorChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#circle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&quot;background&quot;</span><span class="token punctuation">,</span><span class="token function">getRandomColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token string">&quot;colorChange()&quot;</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre></div><p>author: <a href="https://github.com/arluo" target="_blank" rel="noopener noreferrer">arthur<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> / <a href="https://github.com/saviroyu" target="_blank" rel="noopener noreferrer">bryan<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.b01f8b87.js" defer></script><script src="/assets/js/2.7c7b516a.js" defer></script><script src="/assets/js/15.6c792851.js" defer></script>
  </body>
</html>
